---
title: "Data Visualization Makeover Assignment 1"
description: |
  A new article created using the Distill format.
author:
  - name: Zhou Yiou 
    url: https://example.com/norajones
    affiliation: MITB SMU
    affiliation_url: https://example.com/spacelysprokets
date: "`r Sys.Date()`"
output: distill::distill_article
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

```{r}
packages = c('tidyverse', 'readxl', 'knitr')

for(p in packages){
  if(!require(p, character.only = T)){
    install.packages(p)
  }
  library(p, character.only = T)
}
```

```{r}
critiques <- read_xlsx("Data/Critiques.xlsx",
                      sheet = "Sheet1")
```
### 1. Critiques:  
Create table for critiques:

```{r}
knitr::kable(critiques,align="lll")
```

### 2. Alternative Design

The proposed design is as follows.

![](images/draft1.png)

### 3.Proposed Visualisation

Please view the interactive visualization on [here]()


### 4.Step-by-step Guide

#### 4.1 Prepare the dataset

Before getting started:
Once open the excel file, we can find two tables. Upon observation, the initial chart is using table 2 with five years interval, instead of ten, which provide a more detailed overview regarding LFPR. 


1. For each data set(Female, Male and Total), select only the relevant cells. Create three new sheets and insert the cells respectively. Name the sheets"Female", "Male" and "Total" respectively.
2. Import data from the excel file, use Tableau to clean the data. 
   * Select Male table. We'll use tableau to create a pivot table.  Put Measure Values(`#`) in columns, Age(Years)/ Sex in row.
      + Hide numbers from 1991-2009, since we won't use them for the analyse.
   ![](images/03.png)
     + Remove CNT, since we won't need it for the analyse.  
   ![](images/04.png)
   
     + View the data in Tableau.
   ![](images/05.png)
   
     + Put the Measure Names under detail, so the toolkit will show year as an indicator. Export and save the data under the File `Data`. The Data file locates in the same home directory as dv1.rmd
   ![](images/06.png)
   
   * Repeat the steps for the Female and Total as well.
   * Merge the three files into one workbook using MS Excel. Add a column "Category" to differentiate the data source.
  

**No.**|**Move**|**Action**|
-|-|--- |
1|Import the cleaned dataset into Tableau.| |
2|Create the a union by clicking on 'New Union' tab and drag the three tables in into the box.|![](images/07.png)|
3|Adjust the name of the header, change the datatype accordingly. Edit the name of 'measure name' into LFPR|![](images/09.png)|
4|Convert the LFPR into percentage(divided by 100) by adding a calculated field|![](images/10.png)|
5|Add Age (Years) and YEAR to the Column tab and LFPR% to the Rows tab. Change the default Measure (Sum) into Measure (Average).Make it the average for the 3 categories of genders (T, F, M)|![](images/12.png)|
6|Add Category column to detail,Assign category(T,M,F) with different colors.|![](images/13.png)|
_|Take a closer look, for other age groups, the fluctuation of three categories are minor, the year-on-year trend is relatively stable, either grow or decline. Except for age group 20-24 and 25-29. We could make a separate graph later for further investigation.|![](images/14.png)|
7|Select the drop-down menu in the filter tab and select ‘Show Filter’ to display the filter sidebar.|![](images/20.png)|
8|Add year filters, select drop-down list.|![](images/20.png)| 
9|Check out the year from 2011 to 2020. Keep only the 2010 and 2021 for display. |![](images/15.png)|
9.1|Repeat the step for Age(Years), and Category as well.| |
10|Exclude the 70& Over, keep the intervals evenly distributed.|![](images/16.png)|
11|the base graph looks like this|![](images/22.png)|
|Since we focus on the changes happened in the 12 years, so it's important to have the difference calculated.The next would be to create a dual axis with markers showing increase/decrease in percentage. This can be realized by duplicating the axis.|
12|Add another AVG (LFPR%) to create a dual axis.Click on the drop-down list to select dual axis, the second axis would be integrated.|![](images/24.png)|
13|Deselect show header to hide header.|![](images/27.png)|
14|Change panel from Line to Circle to show marks in the main graph.|![](images/25.png)|
15|Adjust the size of the circle by click on the Size button.|![](images/26.png)|
16|Duplicate AVG (LFPR %) in the Rows tab, click on the down arrow, and create a Quick Table Calculation for Percentage Difference.(This row should be deleted later)|![](images/28.png)|
17|Click on the drop-down list, select computing using and ensure that the Pane (across) option is selected.|![](images/29.png)|
18|Double click the variable in the Row tab and copy the formula.|![](images/30.png)|
19|Right Click the blank space in the left hand side and select create a calculated field and change the name to Difference. Repeat the process to create two other variables for the Increase and Decrease respectively.|![](images/31.png)|
20|Here we want to use *Label* to differentiate the Decrease and Increase fields, use red color to highlight decrease and green to mark increase. Start from increase, in order to filter out the negative value for increase, we can edit the Increase Field using *IIF([Difference]>0,[Difference],NULL)*. Repeat the step for decrease. |![](images/34.png)|
20|Drag both the Increase and Decrease fields into the label tab. Double click the Label tab, edit the parameters accordingly, set increase to green, and decrease to red.|![](images/33.png)|
21|Right click on the main graph area and select annotate. Type in insights and observations in the text area. Arrange, resize, or format the resulting text box if required.|![](images/36.png)|
22|Edit Tooltip to delete the "% Difference in Avg. LFPR% from the Previous along Table (Across):"|![](images/37.png)|
23|Change the the format of LFPR% to xx% by select from dropdown list.|![](images/38.png)|













